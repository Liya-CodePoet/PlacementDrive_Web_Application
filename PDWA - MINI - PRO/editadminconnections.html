<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>admin connections</title>
    <link rel="stylesheet"href="">
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.7.2.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
   
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"/>
    </head>
    <style>
      .labs{
  display: inline-block;
  width: 150px;
  margin-left: 80px;
  
  }
  
.container{
    margin-top: 50px;
    
  
}
.btn{
    font-size: 15px;
    font-weight: 500;
    margin: 5px;
   border:1px solid teal;
}
.btn:hover{
   color: white;
   background-color:teal;
}
.btn1{
    font-size: 15px;
    font-weight: 500;
    margin: 5px;
    border-radius: 5px;
    background-color: white;
    padding: 5px 15px;
    padding-bottom: 7px;
    border:1px solid black;
}
.btn1:hover{
    color: white;
   background-color:black;
}
th{
    text-align: center;
    color: white;
    background-color: black;
    text-transform: uppercase;
    border-radius: 2px;
}
#tbody1{
    background-color:teal;
    font-weight: 600;
    border-radius: 5px;
    color: white;
    text-align: center;
   
}
table{
    color: white;
    margin-top: 15px;
    
  }
  h4{
    text-transform: uppercase;
    font-weight: 650;
    text-shadow: 0px 1px 5px teal;
   
  }
  #NameMod,#RegMod1{
    margin-top: 20px;
  }
  #YearMod,#YearMod1{
    margin-bottom: 20px;
  }
  h5{
    color:black;
    text-transform: uppercase;
    text-shadow: 0 0 3px teal;
  }

    </style>
    <body>
        <div class="container">
            <H4>Tie Up Companies</H4> 
            <div class="search">
                <input id="SearchBar" type="text" class="form-control" placeholder="Search" aria-label="Recipient's username" aria-describedby="basic-addon2" onkeyup="searchfunction()"><br>
                 <div >
                    <!-- <button type="button"  class="btn" data-toggle="modal" data-target="#exampleModalCenter"> Add New Record </button>  -->
                    <button type="button"  class="btn1" data-toggle="modal" data-target="#exampleModalCenter2"> Edit Records</button> 
                    <div> 

                        <table class="table py-5">
                            <thread>
                                    <th>Sno</th>
                                    <th>CompanyName</th>
                                    <th>Email</th>
                                    <th>HRName</th>
                                    <th>Contact No</th>
                                    
                            </thread>
                            <tbody id="tbody1"></tbody>
                        </table>
                        
        </div>
<!-- Modal2 starts -->
         
<div class="modal fade" id="exampleModalCenter2" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <form class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle"> Control Panel</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="frame">
            <form action="" class="container">
               
               
                    <label class="labs"for="">Company Name:</label>
                    <input type="text" id="Cn" required="required"><br>
               
                    <label   class="labs" for="">Email:</label>
                    <input type="text" id="Email" required="required"><br>
               
                    <label class="labs" for=""> HR Name:</label>
                    <input type="text" id="HRName" required="required"><br>
                
                    <label class="labs" for=""> Contact No:</label>
                    <input type="text" id="ContactNo" required="required"><br>
                
                
                    
               
                
            
                <div class="modal-footer">
                    <button id="Selbtn" type="button"id="log-btn" class="btn btn-primary">Search </button>
                    <button id="Updbtn" type="button"id="log-btn" class="btn btn-success">Update </button>
                    <button id="Delbtn" type="button"id="log-btn" class="btn btn-danger">Delete </button>
                    <button type="submit"id="log-btn" class="btn btn-secondary">Clear </button>
                </div>
            </form>
        </div>
    </div>
</div>
</div>
<!-- model2 ends -->

         

        <script type="module">

            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.0/firebase-app.js";
      
      const firebaseConfig = {
        apiKey: "AIzaSyCf8TkfipanvrO0Z_FHT9cHv5LvR9ImFfM",
        authDomain: "placementdrive-c2866.firebaseapp.com",
        databaseURL: "https://placementdrive-c2866-default-rtdb.firebaseio.com",
        projectId: "placementdrive-c2866",
        storageBucket: "placementdrive-c2866.appspot.com",
        messagingSenderId: "798924021032",
        appId: "1:798924021032:web:0fcf61762dadde9c42841d"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
 
    
      import { getDatabase, ref, set, child, get ,update,remove} 
        from "https://www.gstatic.com/firebasejs/9.17.0/firebase-database.js";


        const db = getDatabase();

        //--------------------------REFERENCES-----------------------------------------------------------------------------//
        
        var sno=0;
        var tbody=document.getElementById('tbody1');

        function AddItemToTable(CompanyName,Email,HRName,MobileNumber){
          
          let trow = document.createElement("tr");
            let td0=document.createElement('td');
            let td1=document.createElement('td');
            let td2=document.createElement('td');
            let td3=document.createElement('td');
            let td4=document.createElement('td');
           
            td0.innerHTML= ++sno;
            td1.innerHTML=  CompanyName;
            td2.innerHTML= Email;
            td3.innerHTML=HRName;
          
            td4.innerHTML= MobileNumber;
           
            trow.appendChild(td0);
            trow.appendChild(td1);
            trow.appendChild(td2);
            trow.appendChild(td3);
            trow.appendChild(td4);
           
            tbody.appendChild(trow);
        }

        function AddAllItemsToTable(TheQuery){
            sno=0;
            tbody.innerHTML="";
            TheQuery.forEach(element => {
                AddItemToTable(element.CompanyName,element.Email,element.HRName,element.MobileNumber);     
                   });
        }
        //getting all data
        function GetAllDataOnce(){
            const dbRef=ref(db);

            get(child(dbRef,"CompanyList"))
            .then((snapshot)=>{

            var Student=[];

            snapshot.forEach(childSnapshot=> {
                Student.push(childSnapshot.val());
            });
            AddAllItemsToTable(Student);
            });
        }

       
        window.onload = GetAllDataOnce;

 
       

   
 //------------------------- SEARCH BAR FUNCTION--------------------------------------------------//
    
const searchfunction=()=>
{
    let filter=document.getElementById("SearchBar").value.toUpperCase();
    let mytable =document.getElementById('tbody1');
    let tr =mytable.getElementsByTagName('tr');
    for(var i=0;i<tr.length;i++)
    {
        let td=tr[i].getElementsByTagName('td');
        for(j=0;j<td.length;j++)
        {
            if(td[j])
            {
                let textvalue=td[j].textContent || td[j].innerHTML;
               
                if(textvalue.toUpperCase().indexOf(filter)>-1)
                {
                    tr[i].style.display="";
                    break;
                }
                else
                {
                    tr[i].style.display="none";
                }
              }}}}

    //edit details----------------------------------------------------------------------------
        var Cn=document.getElementById('Cn');
        var Email=document.getElementById('Email');
        var HRName=document.getElementById('HRName');
        var ContactNo=document.getElementById('ContactNo');
        var selbtn=document.getElementById("Selbtn");
            var updbtn=document.getElementById("Updbtn");
            var delbtn=document.getElementById("Delbtn");


            //--------------------Search data function---------------------//
            function SelectData()
            {
                const dbref=ref(db);

                get(child(dbref,"CompanyList/"+ Cn.value)).then((snapshot)=>{
                    if(snapshot.exists())
                    {
                        Cn.value=snapshot.val().CompanyName;
                        Email.value=snapshot.val().Email;
                        HRName.value=snapshot.val().HRName;
                        ContactNo.value=snapshot.val().MobileNumber;
                        


                    }
                    else{
                        alert("No Data found 🧐");
                    }

                })
                .catch((error)=>
                {
                    alert("Unsuccessful, Error 🤯"+error);
                });
            }

            //--------------------Update data function---------------------//
            function UpdateData()
            {
                update(ref(db, "CompanyList/"+ Cn.value),
                 {
                   
                   CompanyName: Cn.value,
                   Email: Email.value,
                   HRName: HRName.value,
                   MobileNumber: ContactNo.value,
                  
             })
                 .then(()=>{
                 alert("Data Updated Successfully 👍");
                 })
                 .catch((error)=>{
                 alert("Unsuccessful, Error 🤯"+error);
            
                 });
            }
 //--------------------Delete data function---------------------//
           
 function DeleteData()
            {
               remove(ref(db, "CompanyList/"+ Cn.value)
            
            )
                 .then(()=>{
                 alert("Data Deleted Successfully 👍");
                 }) 
                 .catch((error)=>{
                 alert("Unsuccessful, Error 🤯"+error);
            
                 });
            }


            //--------------------Assign Events to Btns---------------------//
           
            selbtn.addEventListener("click",SelectData);
            updbtn.addEventListener("click",UpdateData);
            delbtn.addEventListener("click",DeleteData);

        </script>
    </body>
    </html>